### http
> http 超文本传输协议，应用层协议，www必须遵守标准，计算机通信必须遵守的规则，允许超文本语言html文档从Web服务器传送到客户端的浏览器。

#### url，uri区别
1. uri同一资源标示符，只是标记资源在哪，存在多个uri指向该资源。（uri包括url）
> 三部分构成：1. 访问资源的命名机制。2.存放资源的主机名。3.资源自身的名称，由路径表示。

2. url统一资源定位符，是uri的子集；除了标识资源的位置，还提供定位资源的主要访问机制。

> 三部分：1. 协议或服务方式. 2.该资源的ip地址. 3.主机资源具体地址(目录文件名)

### 地址栏输入url过程
1. 浏览器输入url
2. 浏览器查看缓存。如请求资源在缓存中，并在有效期。
> 1. 如果资源未缓存，发起新请求。
> 2. 如果有缓存，检验是否在有效期，在有效期直接提供给客户端，否则与服务器进行验证。
> 3. 验证有效期内的http头，进行控制expires和cache-control
>> * http1.0提供expires，值为一个绝对时间表示缓存新鲜日期。
>> * http1.1 增加cache-control:max-age=,值为以秒为单位最大有效期。
3. 浏览器解析url获取协议，主机端口，path
4. 浏览器组装一个http报文
5. 浏览器获取主机ip地址
> 1. 浏览器缓存
> 2. 本机缓存
> 3. 路由器缓存
> 4. ISP DNS缓存
> 5. DNS递归查询

6. 打开一个socket，与目标ip地址，建立tcp连接，三次握手。
> * 客户端发送一个tcp的syn=1，seq=x的包到服务器端口。
> * 服务器发回syn=1，ack=x+1,seq=y的响应包。
> * 客户端发送ack=y+1,seq=z

7. tcp建立连接后，发送http请求
8. 服务器接收到请求，解析，将请求转发到服务程序。
9. 服务检查http头，是否包含缓存验证，如果验证缓存在有效期，返回304等状态码。
10. 处理程序读取完整请求，并准备http响应，处理请求相应的操作。
> 1. 访问量增大，客户端不直接http请求到应用服务器，而且先请求到nginx，nginx在请求应用服务器，将结果返回客户端（nginx反向代理）
> 2. web处理http请求（nginx+php fast-cgi）
>> * 输入url：http://baidu.com
>> * nginx读取配置文件，寻找文件：根据请求头部信息，匹配虚拟主机配置文件中的server_name,如有匹配，访问相应的目录的文件
如果root /data1/www/
请求/data1/www/index.html...
> 3. 把PHP文件交给fastcgi进程处理，处理完成生成html文件，返回nginx一个index.html,nginx返回给浏览器，http协议，浏览器进行展示渲染，nginx记录访问日志。n


11. 服务器将响应报文通过tcp连接发送回浏览器。
12. 浏览器接收http响应，然后根据请求选择关闭或者继续保留。关闭tcp：
> * 主动方发fin=1，ack=z，seq=x报文
> * 被动方发送ack=x+1，seq=z报文
> * 被动方发送fin=1，ack=x，seq=y报文
> * 主动方发送ack=y，seq=y报文。
13. 浏览器检查响应状态码：1xx，2xx，3xx，4xx，5xx
14. 如果资源可缓存，进行缓存
15. 对响应进行解码。
16. 根据资源进行处理（如html文档）
17. 解析html文件，构建dom树，下载资源，构造css，执行js。
18. 显示页面

### 一个完整http事务过程
1. 域名解析
2. 发起tcp请求（3次握手）
3. 建立tcp连接，发起http请求
4. 服务器响应http请求，浏览器得到html代码
5. 浏览器解析html代码，并且请求html代码的资源
6. 浏览器对页面进行渲染
